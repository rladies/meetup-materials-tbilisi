# samushao misamartis gansazghvra
setwd()

setwd("D:\\R\\R\\R_Introductory_Workshops_Geolab\\ggplot2")

# paketis chamotvirtva
install.packages("ggplot2")

# bibliotekis gamodzakheba
library(ggplot2)

# monacemta nakrebis shemotana
d <- ggplot(diamonds)
d <- data.frame(diamonds)
d <- diamonds
d

# shemtxveviti shercheva
dsmall <- diamonds[sample(nrow(diamonds), 100), ]

# sabaziso gamoyeneba - x da y gherdzebi
ggplot(data = d, aes(x = carat, y = price)) + geom_point()

#ggplot() + geom_point(data = d, aes(x = carat, y = price))
#ggplot(d) + geom_point(aes(carat, price))

# log()
ggplot(data = d, aes(log(carat), log(price))) + geom_point()

# cvladebis kombinacia - wrfivi urtiertkavshiri moculobasa da wonas shoris
ggplot(data = d, aes(carat, x * y * z)) + geom_point()

# feri, zoma, forma da sxva "esTetiuru" atributebi - rogorc damatebiTi informacia
ggplot(data = d, aes(carat, price)) + geom_point(aes(colour = color)) # ferebi kategoriebis sachveneblad
ggplot(data = dsmall, aes(carat, price)) + geom_point(aes(colour = color))

ggplot(data = d, aes(carat, price)) + geom_point(aes(shape = cut)) # forma kategoriebis sachveneblad
ggplot(data = dsmall, aes(carat, price)) + geom_point(aes(shape = cut))

ggplot(data = dsmall, aes(carat, price)) + # zoma
  geom_point(aes(colour = color,
                 size = 1))

ggplot(data = d, aes(carat, price)) + geom_point(alpha = 0.1)   # 1/10
ggplot(data = d, aes(carat, price)) + geom_point(alpha = 0.01)  # 1/100
ggplot(data = d, aes(carat, price)) + geom_point(alpha = 0.005) # 1/200

# smoother
ggplot(data = d, aes(carat, price)) + geom_point() + 
  geom_smooth()
ggplot(data = dsmall, aes(carat, price)) + geom_point() + 
  geom_smooth()

ggplot(data = dsmall, aes(carat, price)) + geom_point() + #"span"
  geom_smooth(span = 0.2)

#facets (facet_grid&facet_wrap)
ggplot(data = d, aes(carat, price)) + geom_point() + 
  facet_wrap(~cut)

#plot
dplot <- ggplot(data = d, aes(carat, price)) + geom_point(aes(colour = cut)) + 
  facet_wrap(~cut)
dplot

#legenda
dplot_1 <- dplot + 
  labs(title = "?????????????????????????????? ??????????????????????????????????????? ????????????????????????",
       subtitle = "?????????????????????????????? ????????????????????????????????? ?????????????????????, ?????????????????? ?????? ????????????",
       caption = "???????????????: ggplot2, ????????? ??????????????????????????? ????????????") + 
  xlab("??????????????????") + ylab("????????????") +
  theme(
    plot.title = element_text(colour = "black", size = 14, face = "bold"),
    plot.subtitle = element_text(colour = "black", size = 12),
    plot.caption = element_text(colour = "black", size = 10, face = "italic", 
                                hjust = 1), 
    strip.text = element_text(size = 10, face = "bold"),
    axis.text.x = element_text(size = 8), 
    axis.text.y = element_text(size = 8), 
    legend.position = "bottom", 
    legend.text = element_text(size = 12), 
    legend.justification = 0
  ) + 
  scale_color_discrete(name = "????????????????????????????????? ?????????????????????")

d$cut <- factor(d$cut, levels = c("Fair", "Good", "Very Good", "Premium", "Ideal"), 
                labels = c("?????????????????????", "???????????????", "?????????????????? ???????????????", "????????????????????????", "????????????????????????"))

dplot_1

#plotis shenaxva
ggsave("dplot_1.png", width = 29.7, height = 21, units = "cm")

